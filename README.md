# Чат бот для Вконтакте и Телеграм с интеграцией DialogFlow.

![Peek 2022-03-24 23-55](https://user-images.githubusercontent.com/90130732/159979912-f3d62853-7a69-47fe-86fc-6cdda1e0fa7b.gif)

Чат-бот для Вконтакте и Телеграм. Поведение задается через сервис [DialogFlow](https://dialogflow.cloud.google.com)

Проверить работу бота можно написав сообщение в группе [Вконтакте](https://vk.com/club208544402) или [Телеграм](https://t.me/botforexperimetsbot) 

## Как установить:

Скачать все файлы на свой компьютер.

### Установить зависимости:

Python3 должен быть уже установлен. Далее использовать `pip` (или `pip3`, есть конфликт с python2) для установки
зависимостей:

```
pip install -r requirements.txt
```

## Как использовать:

Для работы сервиса необходимо создать файл `.env` рядом с файлом `main.py` и прописать в нем настройки в
формате `КЛЮЧ='ЗНАЧЕНИЕ'`

Необходимые настройки:

- `TG_TOKEN` — токен телеграм-бота.
- `TG_CHAT_ID` — `chat_id` на который будут отправляться уведомления. Чтобы узнать свой
  `chat_id` можно написать боту `@userinfobot`.
- `PROJECT_ID` - project id от сервиса DialogFlow. [Как создать проект в DialogFlow](https://cloud.google.com/dialogflow/es/docs/quick/setup)
- `GOOGLE_APPLICATION_CREDENTIALS` - полный путь до json ключа от сервиса DialogFlow. [Создание JSON-ключа](https://cloud.google.com/docs/authentication/getting-started)
- `VK_TOKEN` - токен от Вконтакте.
- `LANGUAGE_CODE` - код языка, с которым будет работать бот. По умолчанию русский `'ru'`

### Для запуска Телеграм бота введите команду:

```sh
python tg_bot.py
```

### Для запуска бота Вконтакте введите команду:

```sh
python vk_bot.py
```

ВНИМАНИЕ! Для запуска ботов одновременно вводите команды в разных терминалах.

## Добавить новую реакцию бота:

Бота можно научить отвечать на новые вопросы пользователя. Для этого рядом с файлом
`create_intent.py` необходимо создать файл с названием `questions.json`. 
В файле нужно указать название нового поведения, добавить
возможные вариации вопроса пользователя и ответ на него:

```json
{
  "Устройство на работу": {
    "questions": [
      "Как устроиться к вам на работу?",
      "Как устроиться к вам?",
      "Как работать у вас?",
      "Хочу работать у вас",
      "Возможно-ли устроиться к вам?",
      "Можно-ли мне поработать у вас?",
      "Хочу работать редактором у вас"
    ],
    "answer": "Если вы хотите устроиться к нам, напишите на почту game-of-verbs@gmail.com мини-эссе о себе и прикрепите ваше портфолио."
  }
}
```
После этого запустить команду:
```sh
python create_intent.py
```

## Цель проекта:

Код написан в образовательных целях на курсе для web-разработчиков [dvmn.org](https://dvmn.org/).
